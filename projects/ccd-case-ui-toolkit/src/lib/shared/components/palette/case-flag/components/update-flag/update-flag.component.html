<ng-container [formGroup]="formGroup">
  <div class="govuk-character-count" data-module="govuk-character-count" data-maxlength="200">
    <div class="govuk-form-group" [ngClass]="{'form-group-error': errorMessages.length > 0}">
      <h1 class="govuk-label-wrapper govuk-!-margin-bottom-4">
        <label class="govuk-label govuk-label--l">
          {{ updateFlagTitle | rpxTranslate}}
        </label>
      </h1>
      <div id="update-flag-hint" class="govuk-hint"
        *ngIf="displayContextParameter === caseFlagDisplayContextParameter.UPDATE_EXTERNAL">
        {{selectedFlag?.flagDetailDisplay?.flagDetail | updateFlagTitleDisplay}}
      </div>

      <div class="govuk-!-margin-bottom-4">
        <label class="govuk-label govuk-label--s" [for]="caseFlagFormFields.COMMENTS">
          {{ updateFlagTitle | rpxTranslate}} {{'comments' | rpxTranslate}}
        </label>
        <div id="update-flag-hint" class="govuk-hint">
          {{updateFlagStepEnum.COMMENT_HINT_TEXT | rpxTranslate}}
        </div>
        <div id="update-flag-not-entered-error-message" class="govuk-error-message"
              *ngIf="updateFlagNotEnteredErrorMessage">
          <span class="govuk-visually-hidden">Error:</span> {{updateFlagNotEnteredErrorMessage | rpxTranslate}}
        </div>
        <div id="update-flag-char-limit-error" class="govuk-error-message"
              *ngIf="updateFlagCharLimitErrorMessage">
          <span class="govuk-visually-hidden">Error:</span> {{updateFlagCharLimitErrorMessage | rpxTranslate}}
        </div>
        <textarea class="govuk-textarea" [id]="caseFlagFormFields.COMMENTS"
                  [name]="caseFlagFormFields.COMMENTS" [formControlName]="caseFlagFormFields.COMMENTS" rows="5"
                  aria-describedby="update-flag-hint update-flag-char-limit-info update-flag-char-limit-error">
        </textarea>
        <div id="update-flag-comments-char-limit-info" class="govuk-hint govuk-character-count__message" aria-live="polite">
          {{updateFlagStepEnum.CHARACTER_LIMIT_INFO | rpxTranslate}}
        </div>
      </div>

      <div id="flag-status-container" class="govuk-!-margin-bottom-4"
        *ngIf="displayContextParameter === caseFlagDisplayContextParameter.UPDATE">
        <fieldset class="govuk-fieldset" aria-describedby="update-flag-status-heading">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
            <h1 id="update-flag-status-heading" class="govuk-fieldset__heading">
              {{updateFlagTitle | rpxTranslate}} {{'status' | rpxTranslate}}
            </h1>
          </legend>
          <div class="govuk-radios govuk-radios--conditional govuk-!-margin-bottom-4" data-module="govuk-radios" [id]="caseFlagFormFields.STATUS">
            <div class="govuk-radios__item" *ngFor="let status of validStatusProgressions">
              <input class="govuk-radios__input" type="radio"
                      [id]="caseFlagFormFields.STATUS + '_' + status"
                      [name]="caseFlagFormFields.STATUS"
                      [formControlName]="caseFlagFormFields.STATUS"
                      [value]="status">
              <label class="govuk-label govuk-radios__label" [for]="caseFlagFormFields.STATUS + '_' + status">
                {{ caseFlagStatusEnum[status] | rpxTranslate}}
              </label>
            </div>
          </div>
        </fieldset>

        <div id="update-flag-status-hint" class="govuk-hint">
          {{updateFlagStepEnum.STATUS_HINT_TEXT | rpxTranslate}}
        </div>
        <div id="update-flag-status-reason-not-entered-error-message" class="govuk-error-message"
              *ngIf="statusReasonNotEnteredErrorMessage">
          <span class="govuk-visually-hidden">Error:</span> {{statusReasonNotEnteredErrorMessage | rpxTranslate}}
        </div>
        <div id="update-flag-status-reason-char-limit-error" class="govuk-error-message"
              *ngIf="statusReasonCharLimitErrorMessage">
          <span class="govuk-visually-hidden">Error:</span> {{statusReasonCharLimitErrorMessage | rpxTranslate}}
        </div>
        <textarea class="govuk-textarea"
                  [id]="caseFlagFormFields.STATUS_CHANGE_REASON"
                  [name]="caseFlagFormFields.STATUS_CHANGE_REASON"
                  [formControlName]="caseFlagFormFields.STATUS_CHANGE_REASON"
                  rows="5">
        </textarea>
        <div id="update-flag-status-reason-char-limit-info" class="govuk-hint govuk-character-count__message" aria-live="polite">
          {{updateFlagStepEnum.CHARACTER_LIMIT_INFO | rpxTranslate}}
        </div>
      </div>

      <div class="govuk-!-margin-bottom-6"
        *ngIf="displayContextParameter === caseFlagDisplayContextParameter.UPDATE">
        <div class="govuk-checkboxes" data-module="govuk-checkboxes">
          <div class="govuk-checkboxes__item">
            <input class="govuk-checkboxes__input" type="checkbox"
                   [formControlName]="caseFlagFormFields.IS_WELSH_TRANSLATION_NEEDED"
                   [id]="caseFlagFormFields.IS_WELSH_TRANSLATION_NEEDED"
                   [name]="caseFlagFormFields.IS_WELSH_TRANSLATION_NEEDED">
            <label class="govuk-label govuk-checkboxes__label"
                   [for]="caseFlagFormFields.IS_WELSH_TRANSLATION_NEEDED">
              {{'I need to add a translation' | rpxTranslate}}
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-container>

<div class="govuk-button-group">
  <button id="updateFlagNextButton" class="govuk-button" type="button" (click)="onNext()">
    {{'Next' | rpxTranslate}}
  </button>
</div>
