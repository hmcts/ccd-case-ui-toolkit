<ng-container [formGroup]="formGroup">
  <div class="govuk-form-group" [ngClass]="{'form-group-error': languageNotSelectedErrorMessage || languageEnteredInBothFieldsErrorMessage}">
    <h1 class="govuk-label-wrapper">
      <label class="govuk-label govuk-label--m" [for]="SearchLanguageInterpreterControlNames.LANGUAGE_SEARCH_TERM">
        {{flagType | flagFieldDisplay:'name'}}
      </label>
    </h1>
    <div id="language-search-box-hint" class="govuk-hint">
      {{searchLanguageInterpreterHint | rpxTranslate}}
    </div>
    <div class="auto-complete-container">
      @if (languageNotSelectedErrorMessage) {
        <div id="language-not-selected-error-message" class="govuk-error-message"
          >
          <span class="govuk-visually-hidden">{{'Error:' | rpxTranslate}}</span> {{languageNotSelectedErrorMessage | rpxTranslate}}
        </div>
      }
      @if (languageEnteredInBothFieldsErrorMessage) {
        <div id="language-entered-in-both-fields-error-message" class="govuk-error-message"
          >
          <span class="govuk-visually-hidden">{{'Error:' | rpxTranslate}}</span> {{languageEnteredInBothFieldsErrorMessage | rpxTranslate}}
        </div>
      }
      <input aria-label="Language search box" matInput [formControlName]="SearchLanguageInterpreterControlNames.LANGUAGE_SEARCH_TERM" [matAutocomplete]="autoSearchLanguage"
        class="govuk-input search-language__input" type="text">
      <mat-autocomplete class="mat-autocomplete-panel-extend" autoActiveFirstOption #autoSearchLanguage="matAutocomplete"
        [displayWith]="displayLanguage">
        @for (language of filteredLanguages$ | async; track language) {
          <mat-option [value]="language">
            {{language | languageInterpreterDisplay}}
          </mat-option>
        }
        @if (noResults && searchTerm && searchTerm.length >= minSearchCharacters) {
          <mat-option disabled>{{'No results found' | rpxTranslate}}</mat-option>
        }
      </mat-autocomplete>
    </div>
    <div class="govuk-checkboxes govuk-checkboxes--small govuk-checkboxes--conditional" data-module="govuk-checkboxes">
      <div class="govuk-radios__item">
        <input class="govuk-checkboxes__input" id="enter-language-manually" name="enter-language-manually" type="checkbox"
          (change)="onEnterLanguageManually($event)">
        <label class="govuk-label govuk-checkboxes__label" for="enter-language-manually">
          {{searchLanguageInterpreterStep.CHECKBOX_LABEL | rpxTranslate}}
        </label>
      </div>
      @if (isCheckboxEnabled) {
        <div class="govuk-radios__conditional">
          <div class="govuk-form-group" [ngClass]="{'form-group-error': languageNotEnteredErrorMessage || languageCharLimitErrorMessage }">
            <label class="govuk-label" for="manual-language-entry">{{searchLanguageInterpreterStep.INPUT_LABEL | rpxTranslate}}</label>
            @if (languageNotEnteredErrorMessage) {
              <div id="language-not-entered-error-message" class="govuk-error-message"
                >
                <span class="govuk-visually-hidden">{{'Error:' | rpxTranslate}}</span> {{languageNotEnteredErrorMessage | rpxTranslate}}
              </div>
            }
            @if (languageCharLimitErrorMessage) {
              <div id="language-char-limit-error-message" class="govuk-error-message"
                >
                <span class="govuk-visually-hidden">{{'Error:' | rpxTranslate}}</span> {{languageCharLimitErrorMessage | rpxTranslate}}
              </div>
            }
            <input class="govuk-input govuk-input--width-20" id="manual-language-entry" [name]="SearchLanguageInterpreterControlNames.MANUAL_LANGUAGE_ENTRY" type="text"
              [formControlName]="SearchLanguageInterpreterControlNames.MANUAL_LANGUAGE_ENTRY">
          </div>
        </div>
      }
    </div>
  </div>
</ng-container>
