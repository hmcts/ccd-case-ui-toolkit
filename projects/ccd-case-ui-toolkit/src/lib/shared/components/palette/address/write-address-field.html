<div class="form-group" [id]="id()">
  @if (!isComplexWithHiddenFields()) {
    <div>
      <h2 class="heading-h2">{{caseField | ccdFieldLabel}}</h2>
      @if (!isExpanded) {
        <div class="form-group bottom-30 postcodeLookup" [id]="createElementId('postcodeLookup')" [ngClass]="{'form-group-error': missingPostcode}">
          <label [for]="createElementId('postcodeInput')">
            <span class="form-label">{{'Enter a UK postcode' | rpxTranslate}}</span>
          </label>
          @if (missingPostcode) {
            <span class="error-message">{{errorMessage | rpxTranslate}}</span>
          }
          <input type="text" [ngClass]="{'govuk-input--error': missingPostcode}"
            [id]="createElementId('postcodeInput')" name="postcode" class="form-control postcodeinput inline-block" [formControl]="postcode">
          <button type="button" class="button button-30" (click)="findAddress()">{{'Find address' | rpxTranslate}}</button>
        </div>
      }
      @if (addressOptions) {
        <div class="form-group" id="selectAddress" [ngClass]="{'form-group-error': noAddressSelected}">
          <label [for]="createElementId('addressList')">
            <span class="form-label">{{'Select an address' | rpxTranslate}}</span>
          </label>
          @if (noAddressSelected) {
            <span class="error-message">{{errorMessage | rpxTranslate}}</span>
          }
          <select class="form-control ccd-dropdown addressList" [id]="createElementId('addressList')" name="address" [formControl]="addressList" (change)="addressSelected()" focusElement>
            @for (addressOption of addressOptions; track addressOption) {
              <option [ngValue]="addressOption.value">
                {{addressOption.description | rpxTranslate}}
              </option>
            }
          </select>
        </div>
      }
      @if (!shouldShowDetailFields()) {
        <a class="manual-link bottom-30" (click)="blankAddress()" href="javascript:void(0)">
          {{"I can't enter a UK postcode" | rpxTranslate}}
        </a>
      }
    </div>
  }

  <ccd-write-complex-type-field
    [hidden]="!shouldShowDetailFields()"
    [caseField]="caseField"
    [renderLabel]="false"
    [parent]="parent"
    [formGroup]="formGroup"
    [ignoreMandatory]="true"
    [idPrefix]="buildIdPrefix('detail')"
    #writeComplexFieldComponent>
  </ccd-write-complex-type-field>
</div>
